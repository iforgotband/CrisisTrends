'use strict'; /* global d3 */
/* eslint-disable */

(function () {
  var wordCloudDiv = document.getElementById('wordcloud');
  var quoteDiv = document.getElementById('wordcloud-quote');
  var CLOUD_HEIGHT = 500;
  var svg = d3.select(wordCloudDiv).append('svg');

  var quotes = void 0;
  var cloudWidth = void 0;
  var cloudHeight = CLOUD_HEIGHT;
  var vis = void 0;
  var lastWords = void 0;

  window.bootstrapWordCloud = function () {
    getQuotes();
    initializeD3();

    window.addEventListener('resize-complete', setSVGWidth);
  };

  function getQuotes() {
    var xhr = new XMLHttpRequest();

    xhr.addEventListener('load', function () {
      if (xhr.status === 200) {
        quotes = JSON.parse(xhr.responseText);
      }
    });

    xhr.open('GET', 'data/quotes.json');
    xhr.send();
  }

  function initializeD3() {
    svg.attr('height', cloudHeight);
    setSVGWidth();
    wordCloudDiv.style.display = 'none';
  }

  function setSVGWidth(skipRedraw) {
    cloudWidth = wordCloudDiv.offsetWidth;
    svg.attr('width', cloudWidth);

    if (skipRedraw !== true) {
      doViz();
    }
  }

  function doViz(words) {
    if (words === undefined) {
      if (lastWords === undefined) {
        return;
      }

      words = lastWords;
    } else {
      lastWords = words;
    }

    svg.selectAll('g').remove();

    vis = svg.
    append('g').
    attr('transform', 'translate(' +
    [cloudWidth >> 1, cloudHeight >> 1] +
    ')');

    var max = 0;
    var min = 1000000;

    for (var i in words) {
      if (words[i].c > max) {
        max = words[i].c;
      }

      if (words[i].c < min) {
        min = words[i].c;
      }
    }

    var maxscale = d3.scale.linear().range([50, 120]).domain([10, 960])(cloudWidth);
    var sizeScale = d3.scale.linear().range([12, maxscale]).domain([min, max]);

    d3.layout.cloud().
    size([cloudWidth, cloudHeight]).
    words(words).
    rotate(function () {
      return 0;
    }).
    font('Impact').
    fontSize(function (d) {
      return sizeScale(d.c);
    }).
    text(function (d) {
      return d.w;
    }).
    on('end', draw).
    start();
  }

  function draw(words, bounds) {
    var scale = bounds ? Math.min(
    cloudWidth / Math.abs(bounds[1].x - cloudWidth / 2),
    cloudWidth / Math.abs(bounds[0].x - cloudWidth / 2),
    cloudHeight / Math.abs(bounds[1].y - cloudHeight / 2),
    cloudHeight / Math.abs(bounds[0].y - cloudHeight / 2)) / 2 : 1;

    vis.
    selectAll('text').
    data(words).
    enter().append('text').
    attr('text-anchor', 'middle').
    style('font-size', function (d) {
      return d.size + 'px';
    }).
    style('font-family', 'Impact').
    style('fill', function () {
      return 'rgba(0,0,0,' + (Math.random() * 0.50 + 0.25) + ')';
    }).
    attr('text-anchor', 'middle').
    attr('transform', function (d) {
      return 'translate(' + [d.x, d.y] + ')rotate(' + d.rotate + ')';
    }).
    text(function (d) {
      return d.w;
    });


    vis.attr('transform', 'translate(' + [cloudWidth >> 1, cloudHeight >> 1] + ')scale(' + scale + ')');
  }

  document.getElementById('wordcloud-select').addEventListener('change', function () {
    var issue = this.value;

    wordCloudDiv.style.display = 'block';
    setSVGWidth(true);

    d3.json('data/words/' + issue + '.json', function (error, json) {
      if (error) {
        return console.warn(error);
      }

      if (quotes !== undefined) {
        quoteDiv.innerHTML = '<p>' + quotes[issue] + '</p>';
      }

      doViz(json);
    });
  });
})();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndvcmQtY2xvdWQuanMiXSwibmFtZXMiOlsid29yZENsb3VkRGl2IiwiZG9jdW1lbnQiLCJnZXRFbGVtZW50QnlJZCIsInF1b3RlRGl2IiwiQ0xPVURfSEVJR0hUIiwic3ZnIiwiZDMiLCJzZWxlY3QiLCJhcHBlbmQiLCJxdW90ZXMiLCJjbG91ZFdpZHRoIiwiY2xvdWRIZWlnaHQiLCJ2aXMiLCJsYXN0V29yZHMiLCJ3aW5kb3ciLCJib290c3RyYXBXb3JkQ2xvdWQiLCJnZXRRdW90ZXMiLCJpbml0aWFsaXplRDMiLCJhZGRFdmVudExpc3RlbmVyIiwic2V0U1ZHV2lkdGgiLCJ4aHIiLCJYTUxIdHRwUmVxdWVzdCIsInN0YXR1cyIsIkpTT04iLCJwYXJzZSIsInJlc3BvbnNlVGV4dCIsIm9wZW4iLCJzZW5kIiwiYXR0ciIsInN0eWxlIiwiZGlzcGxheSIsInNraXBSZWRyYXciLCJvZmZzZXRXaWR0aCIsImRvVml6Iiwid29yZHMiLCJ1bmRlZmluZWQiLCJzZWxlY3RBbGwiLCJyZW1vdmUiLCJtYXgiLCJtaW4iLCJpIiwiYyIsIm1heHNjYWxlIiwic2NhbGUiLCJsaW5lYXIiLCJyYW5nZSIsImRvbWFpbiIsInNpemVTY2FsZSIsImxheW91dCIsImNsb3VkIiwic2l6ZSIsInJvdGF0ZSIsImZvbnQiLCJmb250U2l6ZSIsImQiLCJ0ZXh0IiwidyIsIm9uIiwiZHJhdyIsInN0YXJ0IiwiYm91bmRzIiwiTWF0aCIsImFicyIsIngiLCJ5IiwiZGF0YSIsImVudGVyIiwicmFuZG9tIiwiaXNzdWUiLCJ2YWx1ZSIsImpzb24iLCJlcnJvciIsImNvbnNvbGUiLCJ3YXJuIiwiaW5uZXJIVE1MIl0sIm1hcHBpbmdzIjoiY0FBQTtBQUNBOztBQUVBLENBQUMsWUFBVztBQUNWLE1BQU1BLGVBQWVDLFNBQVNDLGNBQVQsQ0FBd0IsV0FBeEIsQ0FBckI7QUFDQSxNQUFNQyxXQUFXRixTQUFTQyxjQUFULENBQXdCLGlCQUF4QixDQUFqQjtBQUNBLE1BQU1FLGVBQWUsR0FBckI7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QixNQUE3QztBQUNEOztBQUVEbkMsWUFBTXFDLElBQU47QUFDRCxLQVZEO0FBV0QsR0FqQkQ7QUFrQkQsQ0FwSkQiLCJmaWxlIjoid29yZC1jbG91ZC5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qIGdsb2JhbCBkMyAqL1xuLyogZXNsaW50LWRpc2FibGUgKi9cblxuKGZ1bmN0aW9uKCkge1xuICBjb25zdCB3b3JkQ2xvdWREaXYgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnd29yZGNsb3VkJyk7XG4gIGNvbnN0IHF1b3RlRGl2ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3dvcmRjbG91ZC1xdW90ZScpO1xuICBjb25zdCBDTE9VRF9IRUlHSFQgPSA1MDA7XG4gIGNvbnN0IHN2ZyA9IGQzLnNlbGVjdCh3b3JkQ2xvdWREaXYpLmFwcGVuZCgnc3ZnJyk7XG5cbiAgbGV0IHF1b3RlcztcbiAgbGV0IGNsb3VkV2lkdGg7XG4gIGxldCBjbG91ZEhlaWdodCA9IENMT1VEX0hFSUdIVDtcbiAgbGV0IHZpcztcbiAgbGV0IGxhc3RXb3JkcztcblxuICB3aW5kb3cuYm9vdHN0cmFwV29yZENsb3VkID0gKCkgPT4ge1xuICAgIGdldFF1b3RlcygpO1xuICAgIGluaXRpYWxpemVEMygpO1xuXG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3Jlc2l6ZS1jb21wbGV0ZScsIHNldFNWR1dpZHRoKTtcbiAgfTtcblxuICBmdW5jdGlvbiBnZXRRdW90ZXMoKSB7XG4gICAgY29uc3QgeGhyID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7XG5cbiAgICB4aHIuYWRkRXZlbnRMaXN0ZW5lcignbG9hZCcsICgpID0+IHtcbiAgICAgIGlmICh4aHIuc3RhdHVzID09PSAyMDApIHtcbiAgICAgICAgcXVvdGVzID0gSlNPTi5wYXJzZSh4aHIucmVzcG9uc2VUZXh0KTtcbiAgICAgIH1cbiAgICB9KTtcblxuICAgIHhoci5vcGVuKCdHRVQnLCAnZGF0YS9xdW90ZXMuanNvbicpO1xuICAgIHhoci5zZW5kKCk7XG4gIH1cblxuICBmdW5jdGlvbiBpbml0aWFsaXplRDMoKSB7XG4gICAgc3ZnLmF0dHIoJ2hlaWdodCcsIGNsb3VkSGVpZ2h0KTtcbiAgICBzZXRTVkdXaWR0aCgpO1xuICAgIHdvcmRDbG91ZERpdi5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICB9XG5cbiAgZnVuY3Rpb24gc2V0U1ZHV2lkdGgoc2tpcFJlZHJhdykge1xuICAgIGNsb3VkV2lkdGggPSB3b3JkQ2xvdWREaXYub2Zmc2V0V2lkdGg7XG4gICAgc3ZnLmF0dHIoJ3dpZHRoJywgY2xvdWRXaWR0aCk7XG5cbiAgICBpZiAoc2tpcFJlZHJhdyAhPT0gdHJ1ZSkge1xuICAgICAgZG9WaXooKTtcbiAgICB9XG4gIH1cblxuICBmdW5jdGlvbiBkb1Zpeih3b3Jkcykge1xuICAgIGlmICh3b3JkcyA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICBpZiAobGFzdFdvcmRzID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICB3b3JkcyA9IGxhc3RXb3JkcztcbiAgICB9IGVsc2Uge1xuICAgICAgbGFzdFdvcmRzID0gd29yZHM7XG4gICAgfVxuXG4gICAgc3ZnLnNlbGVjdEFsbCgnZycpLnJlbW92ZSgpO1xuXG4gICAgdmlzID0gc3ZnXG4gICAgICAuYXBwZW5kKCdnJylcbiAgICAgIC5hdHRyKCd0cmFuc2Zvcm0nLCAndHJhbnNsYXRlKCcgK1xuICAgICAgICBbY2xvdWRXaWR0aCA+PiAxLCBjbG91ZEhlaWdodCA+PiAxXSArXG4gICAgICAgICcpJyk7XG5cbiAgICBsZXQgbWF4ID0gMDtcbiAgICBsZXQgbWluID0gMTAwMDAwMDtcblxuICAgIGZvciAobGV0IGkgaW4gd29yZHMpIHtcbiAgICAgIGlmICh3b3Jkc1tpXS5jID4gbWF4KSB7XG4gICAgICAgIG1heCA9IHdvcmRzW2ldLmM7XG4gICAgICB9XG5cbiAgICAgIGlmICh3b3Jkc1tpXS5jIDwgbWluKSB7XG4gICAgICAgIG1pbiA9IHdvcmRzW2ldLmM7XG4gICAgICB9XG4gICAgfVxuXG4gICAgY29uc3QgbWF4c2NhbGUgPSBkMy5zY2FsZS5saW5lYXIoKS5yYW5nZShbNTAsIDEyMF0pLmRvbWFpbihbMTAsIDk2MF0pKGNsb3VkV2lkdGgpO1xuICAgIGNvbnN0IHNpemVTY2FsZSA9IGQzLnNjYWxlLmxpbmVhcigpLnJhbmdlKFsxMiwgbWF4c2NhbGVdKS5kb21haW4oW21pbiwgbWF4XSk7XG5cbiAgICBkMy5sYXlvdXQuY2xvdWQoKVxuICAgICAgLnNpemUoW2Nsb3VkV2lkdGgsIGNsb3VkSGVpZ2h0XSlcbiAgICAgIC53b3Jkcyh3b3JkcylcbiAgICAgIC5yb3RhdGUoZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiAwO1xuICAgICAgfSlcbiAgICAgIC5mb250KCdJbXBhY3QnKVxuICAgICAgLmZvbnRTaXplKGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgcmV0dXJuIHNpemVTY2FsZShkLmMpO1xuICAgICAgfSlcbiAgICAgIC50ZXh0KGZ1bmN0aW9uKGQpIHtcbiAgICAgICAgcmV0dXJuIGQudztcbiAgICAgIH0pXG4gICAgICAub24oJ2VuZCcsIGRyYXcpXG4gICAgICAuc3RhcnQoKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGRyYXcod29yZHMsIGJvdW5kcykge1xuICAgIGNvbnN0IHNjYWxlID0gYm91bmRzID8gTWF0aC5taW4oXG4gICAgICBjbG91ZFdpZHRoIC8gTWF0aC5hYnMoYm91bmRzWzFdLnggLSBjbG91ZFdpZHRoIC8gMiksXG4gICAgICBjbG91ZFdpZHRoIC8gTWF0aC5hYnMoYm91bmRzWzBdLnggLSBjbG91ZFdpZHRoIC8gMiksXG4gICAgICBjbG91ZEhlaWdodCAvIE1hdGguYWJzKGJvdW5kc1sxXS55IC0gY2xvdWRIZWlnaHQgLyAyKSxcbiAgICAgIGNsb3VkSGVpZ2h0IC8gTWF0aC5hYnMoYm91bmRzWzBdLnkgLSBjbG91ZEhlaWdodCAvIDIpKSAvIDIgOiAxO1xuXG4gICAgdmlzXG4gICAgICAuc2VsZWN0QWxsKCd0ZXh0JylcbiAgICAgIC5kYXRhKHdvcmRzKVxuICAgICAgLmVudGVyKCkuYXBwZW5kKCd0ZXh0JylcbiAgICAgICAgLmF0dHIoJ3RleHQtYW5jaG9yJywgJ21pZGRsZScpXG4gICAgICAgIC5zdHlsZSgnZm9udC1zaXplJywgZnVuY3Rpb24oZCkge1xuICAgICAgICAgIHJldHVybiBkLnNpemUgKyAncHgnO1xuICAgICAgICB9KVxuICAgICAgICAuc3R5bGUoJ2ZvbnQtZmFtaWx5JywgJ0ltcGFjdCcpXG4gICAgICAgIC5zdHlsZSgnZmlsbCcsIGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiAncmdiYSgwLDAsMCwnICsgKE1hdGgucmFuZG9tKCkgKiAwLjUwICsgMC4yNSkgKyAnKSc7XG4gICAgICAgIH0pXG4gICAgICAgIC5hdHRyKCd0ZXh0LWFuY2hvcicsICdtaWRkbGUnKVxuICAgICAgICAuYXR0cigndHJhbnNmb3JtJywgZnVuY3Rpb24oZCkge1xuICAgICAgICAgIHJldHVybiAndHJhbnNsYXRlKCcgKyBbZC54LCBkLnldICsgJylyb3RhdGUoJyArIGQucm90YXRlICsgJyknO1xuICAgICAgICB9KVxuICAgICAgICAudGV4dChmdW5jdGlvbihkKSB7XG4gICAgICAgICAgcmV0dXJuIGQudztcbiAgICAgICAgfSlcbiAgICA7XG5cbiAgICB2aXMuYXR0cigndHJhbnNmb3JtJywgJ3RyYW5zbGF0ZSgnICsgW2Nsb3VkV2lkdGggPj4gMSwgY2xvdWRIZWlnaHQgPj4gMV0gKyAnKXNjYWxlKCcgKyBzY2FsZSArICcpJyk7XG4gIH1cblxuICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnd29yZGNsb3VkLXNlbGVjdCcpLmFkZEV2ZW50TGlzdGVuZXIoJ2NoYW5nZScsIGZ1bmN0aW9uKCkge1xuICAgIGNvbnN0IGlzc3VlID0gdGhpcy52YWx1ZTtcblxuICAgIHdvcmRDbG91ZERpdi5zdHlsZS5kaXNwbGF5ID0gJ2Jsb2NrJztcbiAgICBzZXRTVkdXaWR0aCh0cnVlKTtcblxuICAgIGQzLmpzb24oJ2RhdGEvd29yZHMvJyArIGlzc3VlICsgJy5qc29uJywgZnVuY3Rpb24oZXJyb3IsIGpzb24pIHtcbiAgICAgIGlmIChlcnJvcikge1xuICAgICAgICByZXR1cm4gY29uc29sZS53YXJuKGVycm9yKTtcbiAgICAgIH1cblxuICAgICAgaWYgKHF1b3RlcyAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIHF1b3RlRGl2LmlubmVySFRNTCA9ICc8cD4nICsgcXVvdGVzW2lzc3VlXSArICc8L3A+JztcbiAgICAgIH1cblxuICAgICAgZG9WaXooanNvbik7XG4gICAgfSk7XG4gIH0pO1xufSkoKTtcbiJdfQ==
